# tauri-plugin-axum

[![Crates.io Version](https://img.shields.io/crates/v/tauri-plugin-axum)](https://crates.io/crates/tauri-plugin-axum)
[![NPM Version](https://img.shields.io/npm/v/@mcitem/tauri-plugin-axum)](https://www.npmjs.com/package/@mcitem/tauri-plugin-axum)

# Feature

- [Axios](https://github.com/axios/axios) Adapter

# Install

```bash
cargo add tauri-plugin-axum
```

```bash
pnpm i @mcitem/tauri-plugin-axum
```

```json
// src-tauri/capabilities/default.json
{
  // ..
  "permissions": ["axum:default"]
  // ..
}
```

- [Permissions](https://github.com/mcitem/tauri-plugin-axum/blob/master/tauri-plugin-axum/permissions/autogenerated/reference.md)

# Example

```rust,no_run
#[derive(Serialize, Deserialize)]
struct Greet {
    axum: String,
    tauri: String,
}

async fn post_handle(Json(j): Json<Greet>) -> Json<Greet> {
    Json(Greet {
        axum: format!("axum, {}!", j.axum),
        tauri: format!("tauri, {}!", j.tauri),
    })
}

tauri::Builder::default()
    .plugin(tauri_plugin_axum::init(
        Router::new()
            .route("/", routing::get(|| async { "Hello, World!" }))
            .route("/post", routing::post(post_handle))
    ))

// async init router
tauri::Builder::default()
    .setup(|app| {
        let path = app.path().app_config_dir()?;
        app.handle().plugin(tauri_plugin_axum::block_init(async {
            println!("do something with path: {:?}", path);
            router::router()
        }))?;
        Ok(())
    })
```

```typescript
import { axum } from "@mcitem/tauri-plugin-axum";
axum.get<string>("/").then((response) => {
  console.log(response.body); // "Hello, World!"
});
axum.post<{ axum: string; tauri: string }>("/post", {
  axum: "hello axum",
  tauri: "hello tauri",
});

import { fetch } from "@mcitem/tauri-plugin-axum/fetch";
fetch("/", { method: "GET" })
  .then((res) => res.text())
  .then((res) => {
    console.log(res);
  });

import axios from "axios";
import { Adapter } from "@mcitem/tauri-plugin-axum/axios";
const instance = axios.create({
  adapter: Adapter,
});
```

- [Example](https://github.com/mcitem/tauri-plugin-axum/blob/master/example/tauri-app)

  [main.ts](https://github.com/mcitem/tauri-plugin-axum/blob/master/example/tauri-app/src/main.ts)

  [lib.rs](https://github.com/mcitem/tauri-plugin-axum/blob/master/example/tauri-app/src-tauri/src/lib.rs)

## Run Example

```sh
git clone https://github.com/mcitem/tauri-plugin-axum
cd tauri-plugin-axum
pnpm install
pnpm build
pnpm --filter tauri-app install
pnpm --filter tauri-app tauri dev
```
